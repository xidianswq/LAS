# 参数化配置改进总结

## 概述

本次改进将代码中分散的硬编码参数统一迁移到 `src/utils/config.py` 文件中进行集中管理，实现了参数化设计，提高了代码的可维护性和可配置性。

## 主要改进内容

### 1. 配置文件结构优化

在 `src/utils/config.py` 中新增了以下配置模块：

#### 窗口配置 (WINDOW_CONFIG)
- 主窗口配置：标题、尺寸、最小尺寸、可调整性
- 目标管理窗口配置：标题、尺寸、最小尺寸、编辑窗口尺寸
- 每日任务窗口配置：标题、尺寸、最小尺寸、编辑窗口尺寸

#### 等级系统配置 (LEVEL_SYSTEM_CONFIG)
- 每级经验值：1000
- 最小等级：1
- 最大等级：无上限
- 默认等级和经验值

#### 经验值奖励配置 (EXP_REWARD_CONFIG)
- 目标完成奖励：100经验值
- 每日任务默认奖励：10经验值
- 每日任务最大奖励：100经验值
- 总结完成奖励：50经验值

#### 目标配置 (GOAL_CONFIG)
- 目标类型：月计划、年计划
- 优先级等级：高、中、低
- 状态选项：进行中、已完成、已暂停
- 默认状态和优先级

#### 每日任务配置 (DAILY_TASK_CONFIG)
- 优先级等级和状态选项
- 默认经验值奖励和最大奖励
- 自动重置配置

#### 总结配置 (SUMMARY_CONFIG)
- 总结类型：日总结、周总结、月总结
- 自动保存和内容长度限制

#### 界面配置 (UI_CONFIG)
- 内边距、侧边栏宽度、树形视图高度
- 刷新间隔、时间格式、日期格式

#### 数据库表配置 (DATABASE_TABLES)
- 所有数据库表的创建SQL语句
- 统一的表结构定义

#### 默认数据配置 (DEFAULT_DATA)
- 用户基本信息的默认值
- 统一的初始化数据

#### 消息配置 (MESSAGE_CONFIG)
- 完成消息模板
- 错误、警告、信息前缀

### 2. 代码文件更新

#### main.py
- 使用配置文件中的窗口参数
- 使用配置文件中的数据库表结构
- 使用配置文件中的默认数据

#### src/utils/level_utils.py
- 使用配置文件中的等级系统参数
- 动态计算等级和经验值

#### src/utils/data_manager.py
- 使用配置文件中的经验值奖励参数
- 使用配置文件中的消息模板

#### src/gui/main_window.py
- 使用配置文件中的界面参数
- 使用配置文件中的刷新间隔

#### src/gui/goals_window.py
- 使用配置文件中的窗口参数
- 使用配置文件中的目标配置

#### src/gui/daily_tasks_window.py
- 使用配置文件中的窗口参数
- 使用配置文件中的每日任务配置

### 3. 测试验证

创建了 `test_config.py` 测试文件，验证：
- 所有配置参数正确加载
- 配置参数类型正确
- 配置参数之间的集成正常
- 等级计算功能正常

## 改进效果

### 1. 可维护性提升
- 所有参数集中管理，便于修改和维护
- 避免了硬编码，减少了代码重复
- 配置变更时只需修改一个文件

### 2. 可配置性增强
- 系统行为可以通过配置文件调整
- 支持不同环境的配置需求
- 便于功能扩展和定制

### 3. 代码质量改善
- 提高了代码的可读性
- 减少了魔法数字和硬编码字符串
- 增强了代码的可测试性

### 4. 开发效率提升
- 新功能开发时可以直接使用配置参数
- 减少了重复的参数定义
- 统一的配置管理降低了出错概率

## 配置参数列表

### 窗口配置
```python
WINDOW_CONFIG = {
    "main_window": {
        "title": "LAS",
        "geometry": "800x375",
        "min_width": 400,
        "min_height": 375,
        "resizable": True
    },
    "goals_window": {
        "title": "目标管理",
        "geometry": "900x550",
        "min_width": 700,
        "min_height": 400,
        "edit_geometry": "400x320"
    },
    "daily_tasks_window": {
        "title": "计划管理",
        "geometry": "900x550",
        "min_width": 700,
        "min_height": 400,
        "edit_geometry": "400x300"
    }
}
```

### 等级系统配置
```python
LEVEL_SYSTEM_CONFIG = {
    "exp_per_level": 1000,  # 每级需要的经验值
    "min_level": 1,         # 最小等级
    "max_level": None,      # 最大等级（None表示无上限）
    "default_level": 1,     # 默认等级
    "default_exp": 0        # 默认经验值
}
```

### 经验值奖励配置
```python
EXP_REWARD_CONFIG = {
    "goal_completion": 100,     # 目标完成奖励经验值
    "daily_task_default": 10,   # 每日任务默认奖励经验值
    "daily_task_max": 100,      # 每日任务最大奖励经验值
    "summary_completion": 50     # 总结完成奖励经验值
}
```

## 使用建议

1. **新增配置参数**：在 `config.py` 中定义新的配置项
2. **修改配置**：直接修改 `config.py` 中的参数值
3. **扩展配置**：按照现有模式添加新的配置模块
4. **测试验证**：使用 `test_config.py` 验证配置变更

## 总结

通过参数化配置的改进，LAS系统实现了：
- 统一的配置管理
- 灵活的参数调整
- 更好的代码维护性
- 增强的系统可扩展性

这种设计模式为系统的后续开发和维护奠定了良好的基础。 